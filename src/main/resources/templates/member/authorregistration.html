<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<th:block th:replace="~{/layout/basic::setContent(~{this::content})}">
  <th:block th:fragment="content">
    <head>
      <meta charset="UTF-8">
      <title>회원가입</title>
      <link th:href="@{/css/bootstrap.min.css}" rel="stylesheet">
    </head>
    <body>

    <div class="container">
      <div class="my-4">
        <h2>회원가입</h2>
      </div>
      <form th:action method="post" th:object="${member}">
        <div class="mb-3">
          <label for="memberId">아이디</label>
          <input type="text" id="memberId" th:field="*{memberId}">
          <p id="idng" style="color:red;"></p>
          <p id="idok" style="color:green;"></p>
        </div>
        <div class="mb-3">
          <button class="btn btn-lg btn-primary btn-block" id="idCheck">중복확인</button>
        </div>

        <div class="mb-3">
          <label for="password">패스워드:
            <input id="password" name="password" type="password"
                   required maxlength="8" autocomplete="off">
            <span class="point">* 비밀번호는 총 8자 까지 입력이 가능합니다.</span>
          </label>
        </div>

        <div class="mb-3">
          <label for="passwordCheck">패스워드 확인:   </label>
          <input id="passwordCheck" name="memberPassword" type="password"
                 placeholder="동일하게 입력해 주세요." required maxlength="8" autocomplete="off">
          <p id="ng" style="color:red;"></p>
          <p id="ok" style="color:green;"></p>

        </div>

        <div class="mb-3">
          <label for="memberName" class="form-label">이름</label>
          <input type="text" class="form-control" id="memberName" th:field="*{memberName}">
        </div>

        <div class="mb-3">
          <label for="memberEmail" class="form-label">이메일</label>
          <input type="text" class="form-control" id="memberEmail" th:field="*{memberEmail}">
        </div>

        <div class="mb-3">
          <label for="memberPhoneNumber" class="form-label">휴대폰 번호</label>
          <input type="text" class="form-control" id="memberPhoneNumber" th:field="*{memberPhoneNumber}">
        </div>


          <div class="mb-3">
            <label for="writerLecturePlace" class="form-label">작가 장소</label>
            <input type="text" class="form-control" id="writerLecturePlace" th:field="*{writerLecturePlace}">
          </div>

        <div class="mb-3">
          <label for="availableDay" class="form-label">교육 가능일</label>
          <input type="date" class="form-control" id="availableDay" th:field="*{availableDay}">
        </div>

          <div class="mb-3">
            <label for="availableStartTime" class="form-label">교육 시작 가능 시간</label>
            <input type="time" class="form-control" id="availableStartTime" th:field="*{availableStartTime}">
          </div>


          <div class="mb-3">
            <label for="availableFinishTime" class="form-label">교육 마감 시간</label>
            <input type="time" class="form-control" id="availableFinishTime" th:field="*{availableFinishTime}">
          </div>





        <hr class="my-3">
        <div class="mb-3">
          <div th:each="r : ${roles1}" class="form-check form-check-inline">
            <input type="radio" th:field="*{role}" th:value="${r.value}" class="form-check-input">
            <label th:for="${#ids.prev('role')}" th:text="${r.key}" class="form-check-label"></label>
          </div>
        </div>
        <button type="submit" class="btn btn-primary">회원가입</button>
      </form>


    </div>
    </body>
  </th:block>
</th:block>
<script>
  // 아이디 중복 확인
  $('#idCheck').click(function(e) {
    e.preventDefault()
    const memberId = $('#memberId').val();
    const json = JSON.stringify({
      memberId,
    })
    console.log("????????" + json)

    $.ajax({
      url: '/api/member/idCheck',
      type: 'POST',
      dataType: 'text',
      contentType: "application/json",
      data: json,
      success: function (data) {
        console.log("????????" + data)

        if (data == "ng") {
          document.getElementById('idok').innerHTML = ""
          document.getElementById('idng').innerHTML = "아이디를 입력해주세요."
        } else {
          if (data == "no") {
            document.getElementById('idok').innerHTML = ""
            document.getElementById('idng').innerHTML = "이미 등록된 회원이 었습니다"
            return;

          } else if (data == "ok") {

            document.getElementById('idng').innerHTML = ""
            document.getElementById('idok').innerHTML = "사용가능한 아이디 입니다."
            return;
          }
        }
      },
    })

  })

  //비밀번호 확인
  $(function () {
    $('#passwordCheck').blur(function () {
      if ($('#password').val() != $('#passwordCheck').val()) {
        if ($('#passwordCheck').val() != '') {
          document.getElementById('ng').innerHTML = "동일한 비밀번호를 입력해 주세요"
          // alert("비밀번호가 일치하지 않습니다.");
          $('#passwordCheck').val('');
          $('#passwordCheck').focus();
        }
      } else {
        document.getElementById('ng').innerHTML = ""
        document.getElementById('ok').innerHTML = "동일한 비밀번호 입니다"
      }
    })
  });
</script>
</html>